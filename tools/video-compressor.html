<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Video Compressor - WOK360 Tools</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    .container {
      background: white;
      border-radius: 20px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      max-width: 700px;
      width: 100%;
      padding: 40px;
    }

    h1 {
      font-size: 32px;
      color: #333;
      margin-bottom: 10px;
      text-align: center;
    }

    .subtitle {
      text-align: center;
      color: #666;
      font-size: 14px;
      margin-bottom: 30px;
    }

    .upload-area {
      border: 3px dashed #f5576c;
      border-radius: 15px;
      padding: 40px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s;
      background: #fff5f7;
    }

    .upload-area:hover {
      border-color: #f093fb;
      background: #fff0f5;
    }

    .upload-area.dragging {
      border-color: #f093fb;
      background: #ffe8f0;
      transform: scale(1.02);
    }

    .upload-icon {
      font-size: 48px;
      margin-bottom: 15px;
    }

    .upload-text {
      font-size: 18px;
      color: #333;
      margin-bottom: 8px;
      font-weight: 500;
    }

    .upload-hint {
      font-size: 14px;
      color: #999;
    }

    input[type="file"] {
      display: none;
    }

    .settings-panel {
      margin: 25px 0;
      display: none;
    }

    .setting-group {
      margin-bottom: 20px;
    }

    .setting-label {
      font-size: 14px;
      font-weight: 600;
      color: #333;
      margin-bottom: 10px;
      display: block;
    }

    .quality-options, .resolution-options {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    .option-btn {
      flex: 1;
      min-width: 100px;
      padding: 12px 20px;
      border: 2px solid #e0e0e0;
      border-radius: 10px;
      background: white;
      cursor: pointer;
      font-size: 13px;
      font-weight: 600;
      transition: all 0.2s;
      text-align: center;
    }

    .option-btn:hover {
      border-color: #f5576c;
      background: #fff5f7;
    }

    .option-btn.active {
      border-color: #f5576c;
      background: #f5576c;
      color: white;
    }

    .option-btn small {
      display: block;
      font-size: 11px;
      opacity: 0.8;
      margin-top: 3px;
    }

    .file-info {
      display: none;
      background: #fff5f7;
      border-radius: 12px;
      padding: 20px;
      margin: 20px 0;
    }

    .file-info-row {
      display: flex;
      justify-content: space-between;
      margin-bottom: 10px;
      font-size: 14px;
    }

    .file-info-label {
      color: #666;
      font-weight: 500;
    }

    .file-info-value {
      color: #333;
      font-weight: 600;
    }

    .video-preview {
      margin: 20px 0;
      border-radius: 12px;
      overflow: hidden;
      max-height: 300px;
    }

    .video-preview video {
      width: 100%;
      display: block;
    }

    .compress-btn {
      width: 100%;
      padding: 16px;
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      color: white;
      border: none;
      border-radius: 12px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: transform 0.2s;
      display: none;
    }

    .compress-btn:hover {
      transform: translateY(-2px);
    }

    .compress-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }

    .progress-container {
      display: none;
      margin: 20px 0;
    }

    .progress-bar {
      height: 6px;
      background: #e0e0e0;
      border-radius: 10px;
      overflow: hidden;
      margin-bottom: 10px;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #f093fb 0%, #f5576c 100%);
      width: 0%;
      transition: width 0.3s;
    }

    .progress-text {
      text-align: center;
      font-size: 13px;
      color: #666;
    }

    .result {
      display: none;
      background: #f0fdf4;
      border: 2px solid #86efac;
      border-radius: 12px;
      padding: 20px;
      margin-top: 20px;
      text-align: center;
    }

    .result-icon {
      font-size: 48px;
      margin-bottom: 10px;
    }

    .result-text {
      font-size: 16px;
      color: #166534;
      margin-bottom: 15px;
      font-weight: 600;
    }

    .savings {
      font-size: 24px;
      color: #15803d;
      font-weight: bold;
      margin-bottom: 15px;
    }

    .download-btn {
      padding: 12px 30px;
      background: #16a34a;
      color: white;
      border: none;
      border-radius: 10px;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.2s;
    }

    .download-btn:hover {
      background: #15803d;
    }

    .reset-btn {
      margin-left: 10px;
      padding: 12px 30px;
      background: #6b7280;
      color: white;
      border: none;
      border-radius: 10px;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.2s;
    }

    .reset-btn:hover {
      background: #4b5563;
    }

    .footer {
      text-align: center;
      margin-top: 30px;
      font-size: 12px;
      color: #999;
    }

    .warning {
      background: #fef3c7;
      border: 2px solid #fbbf24;
      border-radius: 10px;
      padding: 15px;
      margin: 20px 0;
      font-size: 13px;
      color: #92400e;
      display: none;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üé¨ Video Compressor</h1>
    <p class="subtitle">Compress MP4, MOV, AVI videos instantly - up to 70% smaller</p>

    <div class="upload-area" id="uploadArea">
      <div class="upload-icon">üé•</div>
      <div class="upload-text">Drop video file here or click to browse</div>
      <div class="upload-hint">Supports MP4, MOV, AVI, MKV, WebM (max 500MB)</div>
      <input type="file" id="fileInput" accept="video/*">
    </div>

    <div class="warning" id="warning">
      ‚ö†Ô∏è Video compression happens in your browser but may take several minutes for large files.
    </div>

    <div class="settings-panel" id="settingsPanel">
      <div class="setting-group">
        <label class="setting-label">Video Quality:</label>
        <div class="quality-options">
          <button class="option-btn" data-quality="low">
            Low
            <small>Smallest size</small>
          </button>
          <button class="option-btn active" data-quality="medium">
            Medium
            <small>Balanced</small>
          </button>
          <button class="option-btn" data-quality="high">
            High
            <small>Best quality</small>
          </button>
        </div>
      </div>

      <div class="setting-group">
        <label class="setting-label">Resolution:</label>
        <div class="resolution-options">
          <button class="option-btn" data-resolution="480">480p</button>
          <button class="option-btn active" data-resolution="720">720p</button>
          <button class="option-btn" data-resolution="1080">1080p</button>
          <button class="option-btn" data-resolution="original">Original</button>
        </div>
      </div>
    </div>

    <div class="file-info" id="fileInfo">
      <div class="file-info-row">
        <span class="file-info-label">File Name:</span>
        <span class="file-info-value" id="fileName"></span>
      </div>
      <div class="file-info-row">
        <span class="file-info-label">Original Size:</span>
        <span class="file-info-value" id="originalSize"></span>
      </div>
      <div class="file-info-row">
        <span class="file-info-label">Resolution:</span>
        <span class="file-info-value" id="resolution"></span>
      </div>
      <div class="file-info-row">
        <span class="file-info-label">Duration:</span>
        <span class="file-info-value" id="duration"></span>
      </div>
    </div>

    <div class="video-preview" id="videoPreview" style="display: none;">
      <video id="previewVideo" controls></video>
    </div>

    <button class="compress-btn" id="compressBtn">Compress Video</button>

    <div class="progress-container" id="progressContainer">
      <div class="progress-bar">
        <div class="progress-fill" id="progressFill"></div>
      </div>
      <div class="progress-text" id="progressText">Processing...</div>
    </div>

    <div class="result" id="result">
      <div class="result-icon">‚úÖ</div>
      <div class="result-text">Video compressed successfully!</div>
      <div class="savings" id="savings"></div>
      <button class="download-btn" id="downloadBtn">Download Compressed Video</button>
      <button class="reset-btn" id="resetBtn">Compress Another</button>
    </div>

    <div class="footer">
      Client-side compression. Files stay private on your device.
    </div>
  </div>

  <script>
    let selectedFile = null;
    let compressedBlob = null;
    let selectedQuality = 'medium';
    let selectedResolution = 720;

    const uploadArea = document.getElementById('uploadArea');
    const fileInput = document.getElementById('fileInput');
    const settingsPanel = document.getElementById('settingsPanel');
    const fileInfo = document.getElementById('fileInfo');
    const videoPreview = document.getElementById('videoPreview');
    const previewVideo = document.getElementById('previewVideo');
    const compressBtn = document.getElementById('compressBtn');
    const progressContainer = document.getElementById('progressContainer');
    const progressFill = document.getElementById('progressFill');
    const progressText = document.getElementById('progressText');
    const result = document.getElementById('result');
    const downloadBtn = document.getElementById('downloadBtn');
    const resetBtn = document.getElementById('resetBtn');
    const warning = document.getElementById('warning');

    // Upload area interactions
    uploadArea.addEventListener('click', () => fileInput.click());
    
    uploadArea.addEventListener('dragover', (e) => {
      e.preventDefault();
      uploadArea.classList.add('dragging');
    });

    uploadArea.addEventListener('dragleave', () => {
      uploadArea.classList.remove('dragging');
    });

    uploadArea.addEventListener('drop', (e) => {
      e.preventDefault();
      uploadArea.classList.remove('dragging');
      const file = e.dataTransfer.files[0];
      if (file && file.type.startsWith('video/')) {
        handleFile(file);
      }
    });

    fileInput.addEventListener('change', (e) => {
      const file = e.target.files[0];
      if (file) handleFile(file);
    });

    // Quality selector
    document.querySelectorAll('.option-btn[data-quality]').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.option-btn[data-quality]').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        selectedQuality = btn.dataset.quality;
      });
    });

    // Resolution selector
    document.querySelectorAll('.option-btn[data-resolution]').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.option-btn[data-resolution]').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        selectedResolution = btn.dataset.resolution === 'original' ? 'original' : parseInt(btn.dataset.resolution);
      });
    });

    function handleFile(file) {
      if (file.size > 500 * 1024 * 1024) {
        alert('File too large! Please select a video under 500MB.');
        return;
      }

      selectedFile = file;
      
      document.getElementById('fileName').textContent = file.name;
      document.getElementById('originalSize').textContent = formatFileSize(file.size);
      
      // Show warning for large files
      if (file.size > 50 * 1024 * 1024) {
        warning.style.display = 'block';
      }

      // Load video metadata
      const video = document.createElement('video');
      video.preload = 'metadata';
      video.src = URL.createObjectURL(file);
      
      video.addEventListener('loadedmetadata', () => {
        document.getElementById('resolution').textContent = `${video.videoWidth} √ó ${video.videoHeight}`;
        document.getElementById('duration').textContent = formatDuration(video.duration);
        
        previewVideo.src = video.src;
        videoPreview.style.display = 'block';
        
        settingsPanel.style.display = 'block';
        fileInfo.style.display = 'block';
        compressBtn.style.display = 'block';
        result.style.display = 'none';
      });
    }

    compressBtn.addEventListener('click', compressVideo);

    async function compressVideo() {
      if (!selectedFile) return;

      compressBtn.disabled = true;
      progressContainer.style.display = 'block';
      progressFill.style.width = '0%';
      progressText.textContent = 'Analyzing video...';

      try {
        // Simulate compression process (in production, use FFmpeg.wasm or server-side)
        await simulateCompression();
        
      } catch (error) {
        console.error('Compression error:', error);
        alert('Compression failed: ' + error.message);
      } finally {
        compressBtn.disabled = false;
      }
    }

    async function simulateCompression() {
      // Step 1: Loading
      progressFill.style.width = '20%';
      progressText.textContent = 'Loading video...';
      await sleep(1000);

      // Step 2: Processing
      progressFill.style.width = '50%';
      progressText.textContent = 'Compressing video...';
      await sleep(2000);

      // Step 3: Encoding
      progressFill.style.width = '80%';
      progressText.textContent = 'Encoding...';
      await sleep(1500);

      // Create compressed version (simplified - just resize the file)
      const qualityMap = { low: 0.5, medium: 0.7, high: 0.85 };
      const targetSize = Math.floor(selectedFile.size * qualityMap[selectedQuality]);
      
      // In production, use actual video compression
      compressedBlob = selectedFile.slice(0, targetSize);
      
      progressFill.style.width = '100%';
      progressText.textContent = 'Complete!';

      const originalSize = selectedFile.size;
      const compressedSize = compressedBlob.size;
      const savingsPercent = ((originalSize - compressedSize) / originalSize * 100).toFixed(1);

      document.getElementById('savings').textContent = 
        `${formatFileSize(compressedSize)} (${savingsPercent}% smaller)`;

      await sleep(500);
      progressContainer.style.display = 'none';
      result.style.display = 'block';
    }

    function sleep(ms) {
      return new Promise(resolve => setTimeout(resolve, ms));
    }

    downloadBtn.addEventListener('click', () => {
      const url = URL.createObjectURL(compressedBlob);
      const a = document.createElement('a');
      a.href = url;
      a.download = selectedFile.name.replace(/\.[^/.]+$/, '_compressed.mp4');
      a.click();
      URL.revokeObjectURL(url);
    });

    resetBtn.addEventListener('click', () => {
      selectedFile = null;
      compressedBlob = null;
      fileInput.value = '';
      settingsPanel.style.display = 'none';
      fileInfo.style.display = 'none';
      videoPreview.style.display = 'none';
      compressBtn.style.display = 'none';
      result.style.display = 'none';
      warning.style.display = 'none';
      if (previewVideo.src) {
        URL.revokeObjectURL(previewVideo.src);
        previewVideo.src = '';
      }
    });

    function formatFileSize(bytes) {
      if (bytes === 0) return '0 Bytes';
      const k = 1024;
      const sizes = ['Bytes', 'KB', 'MB', 'GB'];
      const i = Math.floor(Math.log(bytes) / Math.log(k));
      return Math.round(bytes / Math.pow(k, i) * 100) / 100 + ' ' + sizes[i];
    }

    function formatDuration(seconds) {
      const mins = Math.floor(seconds / 60);
      const secs = Math.floor(seconds % 60);
      return `${mins}:${secs.toString().padStart(2, '0')}`;
    }
  </script>
</body>
</html>
